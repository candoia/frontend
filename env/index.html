<!doctype html>
<html>
  <head>
    <title>Candoia</title>
    <link rel='stylesheet' type='text/css' href='src/css/font-awesome.min.css'>
    <link rel='stylesheet' type='text/css' href='src/css/work-sans.css'>
    <link rel='stylesheet' type='text/css' href='src/css/scaffolding.css'>
    <link rel='stylesheet' type='text/css' href='src/css/candoia.css'>
  </head>
  <body>
    <div class='main-container'>
      <div class='axis axis-horizontal'>
        <div class='panel-container left'>
          <div class='panel left'>
            <p>
              <ul id='repo-tree'class='tree'></ul>
            </p>
            <div style='width: 200px;'></div>
          </div>
        </div>
        <div class='axis axis-vertical'>
          <div class='panel-container top'>
            <div class='panel top'></div>
          </div>
          <div class='pane-container master'>
            <div class='pane-axis horizontal' style='flex-grow: 1'>
              <div class='pane-axis vertical' style='flex-grow: 1'>
                <div class='pane' style='flex-grow: 1'>
                  <div class='pane-header'>
                    Top Performers
                    <i class='close fa fa-fw fa-close'></i>
                  </div>
                  <div class='pane-content'>
                    <div class='pane-body-container'>
                      <div class='pane-body'>
                        <div class='app-content' style="text-align:center;">
                          <h4>Top Users by Commits</h4>
                          <canvas id="pane-a" height='320px' width='320px'></canvas>
                          <table style='width:100%;text-align:left;'>
                            <thead>
                              <tr>
                                <th>User</th>
                                <th>Number of Commits</th>
                                <th>Most Changed File</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td>Dalton Mills</td>
                                <td>150</td>
                                <td>main.html</td>
                              </tr>
                              <tr>
                                <td>David Johnston</td>
                                <td>100</td>
                                <td>ui.js</td>
                              </tr>
                              <tr>
                                <td>Trey Erenberger</td>
                                <td>50</td>
                                <td>bootstrap.js</td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class='pane' style='flex-grow: 1'>
                  <div class='pane-header'>
                    Number of Public Methods
                    <i class='close fa fa-fw fa-close'></i>
                  </div>
                  <div class='pane-content'>
                    <div class='pane-body-container'>
                      <div class='pane-body'>
                        <div class='app-content'>
                          <canvas id="pane-npm" height='320px' width='320px'></canvas>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class='pane' style='flex-grow: 1'>
                <div class='pane-header'>
                  Number of Attributes
                  <i class='close fa fa-fw fa-close'></i>
                </div>
                <div class='pane-content'>
                  <div class='pane-body-container'>
                    <!-- <div class='pane-body'> -->
                      <webview class='pane-body app-container' id='app-container' src='../apps/impactful-commits/main.html' preload='../modules/preload.js' ></webview>
                    <!-- </div> -->
                  </div>
                </div>
              </div>
              <div class='pane-axis vertical' style='flex-grow: 1'>
                <div class='pane' style='flex-grow: 1'>
                  <div class='pane-header'>
                    Pane D
                    <i class='close fa fa-fw fa-close'></i>
                  </div>
                  <div class='pane-content'>
                    <div class='pane-body-container'>
                      <div class='pane-body'>
                        <div id="shortcut-container"></div>
                        Hello World
                      </div>
                    </div>
                  </div>
                </div>
                <div class='pane' style='flex-grow: 1'>
                  <div class='pane-header'>
                    Number of Attributes
                    <i class='close fa fa-fw fa-close'></i>
                  </div>
                  <div class='pane-content'>
                    <div class='pane-body-container'>
                      <webview class='pane-body app-container' id='app-container' src='../apps/impactful-commits/main.html' preload='../modules/preload.js' ></webview>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class='panel-container bottom'>
            <div class='panel bottom'>
              <div class='footer'>
                <p style='float: left'>
                   Help
                  <i class='fa fa-fw fa-life-bouy'></i>
                </p>
                <p style='float: left;'>
                   Configuration
                  <i class='fa fa-fw fa-cog'></i>
                </p>
                <p style='float: right;'>
                  <input type='text'></input>
                  <i class='fa fa-fw fa-lg fa-search'></i>
                </p>
                <p style='float: right;'>
                  There is an update avaliable!
                  <i class='fa fa-fw fa-warning'></i>
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class='panel-container right'>
        </div>
      </div>
    </div>
    <script src="../apps/impactful-commits/lib/chart.min.js"></script>
    <script>
      'use strict';

      let fs = require('fs');
      let bootstrap = require('./src/js/bootstrap');

      let dom = {
        byId: document.getElementById.bind(document),
        query: document.querySelectorAll.bind(document),
        create: document.createElement.bind(document)
      }
      NodeList.prototype.forEach = Array.prototype.forEach;

      for(let app of bootstrap.appData.apps) {
        dom.byId('shortcut-container').innerHTML = `<a href="#">${app.name}</a>`;
      }

      for(let repo of bootstrap.appData.repositories) {
        let item = dom.create('li');
        item.innerHTML = `<i class='fa fa-lg fa-fw fa-book'></i> ${repo.name}`
        dom.byId('repo-tree').appendChild(item);
      }



      let scaff = fs.readFileSync('env/src/css/scaffolding.css', {encoding: 'utf8'});
      var webviews = dom.query('.app-container');
      console.log(webviews);
      // webview.addEventListener('console-message', function(e) {
      //   console.log(e.message);
      // });

      var pieA = new Chart(dom.byId('pane-a').getContext('2d')).Pie([
          {
              value: 300,
              color:"#F7464A",
              highlight: "#FF5A5E",
              label: "Dalton Mills"
          },
          {
              value: 50,
              color: "#46BFBD",
              highlight: "#5AD3D1",
              label: "Trey Erenberger"
          },
          {
              value: 100,
              color: "#FDB45C",
              highlight: "#FFC870",
              label: "David Johnston"
          }
      ], {
        responsive: false
      });
      var pieB = new Chart(dom.byId('pane-npm').getContext('2d')).Pie([
          {
              value: 300,
              color:"#F7464A",
              highlight: "#FF5A5E",
              label: "Dalton Mills"
          },
          {
              value: 50,
              color: "#46BFBD",
              highlight: "#5AD3D1",
              label: "Trey Erenberger"
          },
          {
              value: 100,
              color: "#FDB45C",
              highlight: "#FFC870",
              label: "David Johnston"
          }
      ], {
        responsive: false
      });
      webviews.forEach(function(view) {
        view.addEventListener('dom-ready', function() {
          view.insertCSS(scaff);
          // webview.openDevTools();
        });
      });
    </script>
    <!-- <script src='src/js/ui.js'></script> -->
  </body>
</html>
